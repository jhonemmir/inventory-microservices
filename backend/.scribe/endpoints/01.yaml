name: 'Gestión de Inventario'
description: |-

  APIs para consultar y gestionar productos, stock y predicciones de agotamiento.

  Las predicciones de IA se almacenan tanto en Redis (para acceso rápido) como en MySQL
  (para persistencia). El endpoint muestra de dónde proviene la predicción actual.
endpoints:
  -
    custom: []
    httpMethods:
      - GET
    uri: 'api/products/{id}'
    metadata:
      custom: []
      groupName: 'Gestión de Inventario'
      groupDescription: |-

        APIs para consultar y gestionar productos, stock y predicciones de agotamiento.

        Las predicciones de IA se almacenan tanto en Redis (para acceso rápido) como en MySQL
        (para persistencia). El endpoint muestra de dónde proviene la predicción actual.
      subgroup: ''
      subgroupDescription: ''
      title: 'Consultar Producto'
      description: |-
        Obtiene la información actual del producto, incluyendo la predicción de agotamiento de stock
        calculada por el AI Worker y la fuente de los datos (Redis o MySQL).

        La respuesta incluye:
        - Información básica del producto (nombre, precio, stock actual)
        - Predicción de IA sobre cuándo se agotará el inventario
        - Fuente de la predicción (Redis para acceso rápido o MySQL como respaldo)
      authenticated: false
      deprecated: false
    headers:
      Content-Type: application/json
      Accept: application/json
    urlParameters:
      id:
        custom: []
        name: id
        description: 'ID del producto a consultar.'
        required: true
        example: 1
        type: integer
        enumValues: []
        exampleWasSpecified: true
        nullable: false
        deprecated: false
    cleanUrlParameters:
      id: 1
    queryParameters: []
    cleanQueryParameters: []
    bodyParameters: []
    cleanBodyParameters: []
    fileParameters: []
    responses:
      -
        custom: []
        status: 200
        content: |-
          {
            "product": "Camisa Laravel",
            "price": "25.00",
            "stock": 35,
            "ai_prediction": "Se agota en 13.5 días",
            "source": "Redis (RAM)"
          }
        headers: []
        description: 'Producto con predicción en Redis'
      -
        custom: []
        status: 200
        content: |-
          {
            "product": "Pantalón Django",
            "price": "45.00",
            "stock": 20,
            "ai_prediction": "⚠️ ¡CRÍTICO! Se agota hoy",
            "source": "MySQL (Disk)"
          }
        headers: []
        description: 'Producto con predicción en MySQL'
      -
        custom: []
        status: 200
        content: |-
          {
            "product": "Zapatos FastAPI",
            "price": "60.00",
            "stock": 50,
            "ai_prediction": "Calculando...",
            "source": "MySQL (Disk)"
          }
        headers: []
        description: 'Producto sin predicción aún'
      -
        custom: []
        status: 404
        content: |-
          {
            "message": "No query results for model [App\\Models\\Product] 999"
          }
        headers: []
        description: 'Producto no encontrado'
    responseFields: []
    auth: []
    controller: null
    method: null
    route: null
  -
    custom: []
    httpMethods:
      - POST
    uri: 'api/products/{id}/restock'
    metadata:
      custom: []
      groupName: 'Gestión de Inventario'
      groupDescription: |-

        APIs para consultar y gestionar productos, stock y predicciones de agotamiento.

        Las predicciones de IA se almacenan tanto en Redis (para acceso rápido) como en MySQL
        (para persistencia). El endpoint muestra de dónde proviene la predicción actual.
      subgroup: ''
      subgroupDescription: ''
      title: 'Reabastecer Stock'
      description: |-
        Agrega unidades al inventario del producto y dispara un evento a RabbitMQ para que
        el AI Worker recalcule la predicción de agotamiento basándose en el nuevo stock.

        Este endpoint es útil para simular reabastecimientos y ver cómo afectan a las
        predicciones de la IA sobre el agotamiento del inventario.
      authenticated: false
      deprecated: false
    headers:
      Content-Type: application/json
      Accept: application/json
    urlParameters:
      id:
        custom: []
        name: id
        description: 'ID del producto a reabastecer.'
        required: true
        example: 1
        type: integer
        enumValues: []
        exampleWasSpecified: true
        nullable: false
        deprecated: false
    cleanUrlParameters:
      id: 1
    queryParameters: []
    cleanQueryParameters: []
    bodyParameters:
      quantity:
        custom: []
        name: quantity
        description: 'Cantidad de unidades a agregar al stock. Debe ser mayor a 0.'
        required: true
        example: 20
        type: integer
        enumValues: []
        exampleWasSpecified: true
        nullable: false
        deprecated: false
    cleanBodyParameters:
      quantity: 20
    fileParameters: []
    responses:
      -
        custom: []
        status: 200
        content: |-
          {
            "message": "Stock actualizado",
            "new_stock": 70
          }
        headers: []
        description: 'Stock reabastecido exitosamente'
      -
        custom: []
        status: 404
        content: |-
          {
            "message": "No query results for model [App\\Models\\Product] 999"
          }
        headers: []
        description: 'Producto no encontrado'
      -
        custom: []
        status: 422
        content: |-
          {
            "message": "The given data was invalid.",
            "errors": {
              "quantity": ["The quantity field is required."]
            }
          }
        headers: []
        description: 'Validación fallida'
    responseFields: []
    auth: []
    controller: null
    method: null
    route: null
